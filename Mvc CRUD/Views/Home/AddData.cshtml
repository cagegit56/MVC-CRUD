@{
    ViewData["Title"] = Model != null && Model.Id == 0 ? "Add Data" : "Edit Data";
}


@model Mvc_CRUD.Models.Chat

<div class="text-center" >
    <h1 class="mt-4">@(Model != null && Model.Id == 0 ? "Add Data" : "Edit Data")</h1>
    <br />
</div>
<br />
<a class="nav-link text-dark" asp-area="" asp-controller="Home" asp-action="Index">View All Data</a>

@* Removes ModelState errors on the initial page load *@
@using (Html.BeginForm("AddData", "Home", FormMethod.Post, new { id = "AddingDataForm" }))
{
    @Html.HiddenFor(m => m.Id)
}

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        @TempData["SuccessMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

@if (TempData["ErrorMessage"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
        @TempData["ErrorMessage"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}


<form asp-action="AddData" asp-controller="Home" id="AddingDataForm" method="post" >

    <input asp-for="Id" type="hidden" />

    <div class="form-group">
        <label class="mt-4" style="color:darkgray"><b>UserName</b></label>
    <input class="form-control" type="text" placeholder="From User" asp-for="UserName"/>
    <span asp-validation-for="UserName" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label class="mt-4" style="color:darkgray" ><b>ToUser</b></label>
    <input class="form-control" type="text" placeholder="To User" asp-for="ToUser"/>
    <span asp-validation-for="ToUser" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label class="mt-4" style="color:darkgray"><b>Message</b></label>
    <input class="form-control" type="text" placeholder="Type a Meassage" asp-for="Message"/>
    <span asp-validation-for="Message" class="text-danger"></span>
    </div>

    <button class="btn btn-primary mt-4" type="submit" id="submitBtn">
        @(Model != null && Model.Id == 0 ? "Submit" : "Update")
    </button>

</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />

    <script>
        $(document).ready(function () {
            let form = $("#AddingDataForm");
            let submitBtn = $("#submitBtn");

            function toggleSubmit() {
                if (form.valid()) {
                    submitBtn.prop("disabled", false);
                } else {
                    submitBtn.prop("disabled", true);
                }
            }

            form.on("keyup change", "input", toggleSubmit);
            toggleSubmit();
        });
    </script>
}



